(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{134:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game",function(){return l(2961)}])},2961:function(e,a,l){"use strict";l.r(a),l.d(a,{__N_SSP:function(){return N},default:function(){return v}});var t=l(5893),s=l(7294),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.367.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=(e,a)=>{let l=(0,s.forwardRef)(({color:l="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,...u},m)=>(0,s.createElement)("svg",{ref:m,...n,width:t,height:t,stroke:l,strokeWidth:o?24*Number(i)/Number(t):i,className:["lucide",`lucide-${r(e)}`,c].join(" "),...u},[...a.map(([e,a])=>(0,s.createElement)(e,a)),...Array.isArray(d)?d:[d]]));return l.displayName=`${e}`,l},o=i("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),c=i("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),d=i("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),u=i("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),m=i("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),x=i("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);function h(e){if(1===e)return 8;if(2===e)return 7;if(e>=3&&e<=5)return 6;throw Error("Invalid number of players. Must be between 1 and 5.")}function p(e){let a=[],l=e.hands[e.currentPlayer];if(!l)return[];for(let t of l)for(let l of e.piles)("ascending"===l.direction?t>l.value||t===l.value-10:t<l.value||t===l.value+10)&&a.push({card:t,pileId:l.id});return a}function f(e,a){let l=JSON.parse(JSON.stringify(e)),t=l.hands[l.currentPlayer];for(let e of a){let a=l.piles.find(a=>a.id===e.pileId);if(a){a.value=e.card;let l=t.indexOf(e.card);l>-1&&t.splice(l,1)}}return l.cardsPlayed+=a.length,l}let g=function(e,a){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{playExtraTendency:t=.5,maxAllowedJump:s=99,pileHealthCaution:n=.5}=l,r=[...e.hands[a]];if(0===r.length)return[];let i=e.deck.length>0?2:1,o=[],c=[...e.piles.map(e=>({...e}))],d=[...r];function u(l,t){let s={...e,hands:[...e.hands.slice(0,a),l,...e.hands.slice(a+1)],piles:t,currentPlayer:a};return p(s)}function m(e){return e.filter(e=>{let l=c.find(a=>a.id===e.pileId);return void 0===l.bookedBy||l.bookedBy===a})}for(let e=0;e<i;e++){let e=u(d,c),a=m(e);if(0===(e=a.length>0?a:e).length)break;let l=e.find(e=>{let a=c.find(a=>a.id===e.pileId);return 10===Math.abs(e.card-a.value)});if(!l){let a=1/0;for(let t of e){let e=c.find(e=>e.id===t.pileId),s=Math.abs(t.card-e.value);s<a&&(a=s,l=t)}}if(!l)break;o.push(l),d=d.filter(e=>e!==l.card),c=c.map(e=>e.id===l.pileId?{...e,value:l.card}:e)}for(;;){let e,a=u(d,c),l=m(a);if(0===(a=l.length>0?l:a).length)break;for(let l of a){let a=c.find(e=>e.id===l.pileId),t=l.card-a.value,r=Math.abs(t);if(1===r||10===r||r<=s&&(n<.5||("ascending"===a.direction?l.card<90:l.card>10))){e=l;break}}if(!e||Math.random()>t)break;o.push(e),d=d.filter(a=>a!==e.card),c=c.map(a=>a.id===e.pileId?{...a,value:e.card}:a)}return o};function b(e,a,l){let t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=function(){let e=Array.from({length:98},(e,a)=>a+2);for(let a=e.length-1;a>0;a--){let l=Math.floor(Math.random()*(a+1));[e[a],e[l]]=[e[l],e[a]]}return e}(),l=h(e),t=[];for(let s=0;s<e;s++){let e=a.splice(0,l);e.sort((e,a)=>e-a),t.push(e)}return{deck:a,piles:[{id:1,direction:"ascending",value:1},{id:2,direction:"ascending",value:1},{id:3,direction:"descending",value:100},{id:4,direction:"descending",value:100}],hands:t,currentPlayer:0,cardsPlayed:0}}(a);null==l||l("--- Starting a new game with ".concat(a," players ---\n"));let s=Array.isArray(e)?e:Array(a).fill(e);for(;;){let e=t.currentPlayer,a=s[e];null==l||l("\n--- Player ".concat(e+1,"'s Turn ---")),null==l||l("Piles: ".concat(JSON.stringify(t.piles.map(e=>e.value)))),null==l||l("Hand:  ".concat(JSON.stringify(t.hands[e])));let n=t.deck.length>0?2:1,r=0,i=[],o={...t};for(;r<n;){let l=a(o,e);if(0===l.length)break;i.push(...l),o=f(o,l),r+=l.length}if(r<n){null==l||l("Player ".concat(e+1," cannot play the required ").concat(n," cards. GAME OVER."));break}t=f(t,i),i.length>0?(null==l||l("Plays: ".concat(JSON.stringify(i))),null==l||l("Piles after play: ".concat(JSON.stringify(t.piles.map(e=>e.value))))):null==l||l("Plays: No moves were made.");let c=[...t.hands[e]];t=function(e){let a=JSON.parse(JSON.stringify(e)),l=h(a.hands.length),t=a.hands[a.currentPlayer],s=Math.min(l-t.length,a.deck.length),n=a.deck.splice(0,s);return t.push(...n),t.sort((e,a)=>e-a),a}(t);let d=t.hands[e].filter(e=>!c.includes(e));if(d.length>0&&(null==l||l("Draws: ".concat(JSON.stringify(d))),null==l||l("New Hand: ".concat(JSON.stringify(t.hands[e])))),"function"==typeof a.updateBooking){let s=a.updateBooking(t,e);if(s){let a=t.piles.find(e=>e.id===s.pileId);a&&("book"===s.action?(a.bookedBy=e,null==l||l("Player ".concat(e+1," books pile ").concat(a.id))):"release"===s.action&&a.bookedBy===e&&(a.bookedBy=void 0,null==l||l("Player ".concat(e+1," releases pile ").concat(a.id))))}}let u=t.hands.reduce((e,a)=>e+a.length,0);if(0===u&&0===t.deck.length){null==l||l("--- GAME WON: All cards have been played! ---");break}t=function(e){let a=JSON.parse(JSON.stringify(e));return a.currentPlayer=(a.currentPlayer+1)%a.hands.length,a}(t)}let n=98-t.cardsPlayed;return null==l||l("\n--- Game Finished ---"),null==l||l("Cards left: ".concat(n)),n}function y(e,a,l){let t=0,s=0;for(let n=0;n<a;n++){let a=b(e,l);0===a&&s++,t+=a}return{numberOfGames:a,numberOfPlayers:l,wins:s,averageCardsLeft:t/a}}g.updateBooking=function(e,a){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{bookingFrequency:t=0}=l;if(0===t)return null;e.hands[a];let s=p({...e,currentPlayer:a}),n=a=>e.piles.find(e=>e.id===a.pileId);if(t>=1){let e=s.find(e=>{let l=n(e);return 10===Math.abs(e.card-l.value)&&(void 0===l.bookedBy||l.bookedBy===a)});if(e)return{pileId:e.pileId,action:"book"}}if(t>=2){let e=s.find(e=>{let l=n(e);return 1===Math.abs(e.card-l.value)&&(void 0===l.bookedBy||l.bookedBy===a)});if(e)return{pileId:e.pileId,action:"book"}}let r=e.piles.find(e=>e.bookedBy===a);return r?{pileId:r.id,action:"release"}:null};var N=!0;function v(){let[e,a]=(0,s.useState)(2),[l,n]=(0,s.useState)(.5),[r,i]=(0,s.useState)(99),[h,p]=(0,s.useState)(.5),[f,N]=(0,s.useState)("single"),[v,j]=(0,s.useState)(1e3),[w,k]=(0,s.useState)(50),[C,S]=(0,s.useState)(null),[P,O]=(0,s.useState)(!1),[M,B]=(0,s.useState)(0),[J,A]=(0,s.useState)([]),[E,I]=(0,s.useState)([0,.5,1]),[L,_]=(0,s.useState)([1,10,99]),[R,q]=(0,s.useState)([0,.5,1]),[T,G]=(0,s.useState)([0,1,2]),F={playExtraTendency:l,maxAllowedJump:r,pileHealthCaution:h,bookingFrequency:M},H=async()=>{if(O(!0),S(null),"single"===f){let a=[];b((e,a)=>g(e,a,F),e,e=>a.push(e)),S({mode:f,numPlayers:e,playExtraTendency:l,maxAllowedJump:r,pileHealthCaution:h,log:a})}else if("multi"===f){let a=y((e,a)=>g(e,a,F),v,e);S({mode:f,numPlayers:e,playExtraTendency:l,maxAllowedJump:r,pileHealthCaution:h,numGames:v,winRate:a.wins/a.numberOfGames,avgCardsLeft:a.averageCardsLeft})}else if("search"===f){let a=[];A([]);let l=function(e,a,l){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,s=arguments.length>4?arguments[4]:void 0,n=[];for(let a of e.playExtraTendency)for(let l of e.maxAllowedJump)for(let t of e.pileHealthCaution)for(let s of e.bookingFrequency)n.push({playExtraTendency:a,maxAllowedJump:l,pileHealthCaution:t,bookingFrequency:s});let r=n.slice(0,t),i=[],o=0;for(let e of r){o++,null==s||s("Testing combo ".concat(o,"/").concat(r.length,": ").concat(JSON.stringify(e)));let t=y((a,l)=>g(a,l,e),a,l);i.push({...e,winRate:t.wins/t.numberOfGames,avgCardsLeft:t.averageCardsLeft})}return i.sort((e,a)=>a.winRate-e.winRate||e.avgCardsLeft-a.avgCardsLeft),i}({playExtraTendency:E,maxAllowedJump:L,pileHealthCaution:R,bookingFrequency:T},v,e,w,e=>{a.push(e),A([...a])});S({mode:f,results:l})}O(!1)};return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 px-4 flex flex-col items-center",children:(0,t.jsxs)("div",{className:"w-full max-w-2xl bg-white rounded-xl shadow-lg p-8",children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold mb-6 flex items-center gap-2",children:[(0,t.jsx)(u,{className:"w-8 h-8 text-blue-500"}),"The Game â€” Simulation Lab"]}),(0,t.jsxs)("form",{className:"space-y-6",onSubmit:e=>{e.preventDefault(),H()},children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("label",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(c,{className:"w-4 h-4"})," Number of players"]}),(0,t.jsx)("input",{type:"number",min:1,max:5,value:e,onChange:e=>a(Number(e.target.value)),className:"input input-bordered w-full max-w-xs"})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("label",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(d,{className:"w-4 h-4"})," Tendency to play extra cards"]}),(0,t.jsx)("input",{type:"range",min:0,max:1,step:.01,value:l,onChange:e=>n(Number(e.target.value))}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:l}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:"0 = never play extra cards, 1 = always play extra cards if allowed. Controls how likely the player is to play more than the minimum required cards."})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("label",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(d,{className:"w-4 h-4"})," Max allowed jump for extra cards"]}),(0,t.jsx)("input",{type:"range",min:1,max:99,step:1,value:r,onChange:e=>i(Number(e.target.value))}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:r}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:"1 = only direct followers/10-jumps, 99 = allow any jump. Controls how big a jump you're willing to make for extra cards (riskiness)."})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("label",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(d,{className:"w-4 h-4"})," Pile health caution"]}),(0,t.jsx)("input",{type:"range",min:0,max:1,step:.01,value:h,onChange:e=>p(Number(e.target.value))}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:h}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:'0 = don\'t care about pile health, 1 = never "waste" a pile. Controls how cautious the player is about leaving piles in a good state for the future.'})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("label",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(d,{className:"w-4 h-4"})," Pile booking frequency"]}),(0,t.jsxs)("select",{value:M,onChange:e=>B(Number(e.target.value)),className:"input input-bordered w-full max-w-xs",children:[(0,t.jsx)("option",{value:0,children:"Never book a pile"}),(0,t.jsx)("option",{value:1,children:"Book if a 10-jump is available"}),(0,t.jsx)("option",{value:2,children:"Book if a 10-jump or \xb11 is available"})]}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:'Controls how often the player will "book" a pile to signal intent to other players.'})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("label",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(m,{className:"w-4 h-4"})," Simulation mode"]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("button",{type:"button",className:"flex items-center gap-2 px-4 py-2 rounded-lg border transition-all ".concat("single"===f?"bg-blue-100 border-blue-500 text-blue-700 shadow":"bg-white border-gray-300 text-gray-700"," hover:border-blue-400"),onClick:()=>N("single"),children:["single"===f&&(0,t.jsx)(x,{className:"w-4 h-4 text-blue-500"}),"Single Game (Verbose)"]}),(0,t.jsxs)("button",{type:"button",className:"flex items-center gap-2 px-4 py-2 rounded-lg border transition-all ".concat("multi"===f?"bg-blue-100 border-blue-500 text-blue-700 shadow":"bg-white border-gray-300 text-gray-700"," hover:border-blue-400"),onClick:()=>N("multi"),children:["multi"===f&&(0,t.jsx)(x,{className:"w-4 h-4 text-blue-500"}),"Multiple Simulations"]}),(0,t.jsxs)("button",{type:"button",className:"flex items-center gap-2 px-4 py-2 rounded-lg border transition-all ".concat("search"===f?"bg-blue-100 border-blue-500 text-blue-700 shadow":"bg-white border-gray-300 text-gray-700"," hover:border-blue-400"),onClick:()=>N("search"),children:["search"===f&&(0,t.jsx)(x,{className:"w-4 h-4 text-blue-500"}),"Parameter Search (Find Optimal)"]})]}),"multi"===f&&(0,t.jsxs)("div",{className:"flex flex-col gap-2 mt-2",children:[(0,t.jsx)("label",{className:"text-sm",children:"Number of games"}),(0,t.jsx)("input",{type:"number",min:1,max:1e4,value:v,onChange:e=>j(Number(e.target.value)),className:"input input-bordered w-full max-w-xs"})]}),"search"===f&&(0,t.jsxs)("div",{className:"flex flex-col gap-2 mt-2",children:[(0,t.jsx)("label",{className:"text-sm",children:"Number of games per combo"}),(0,t.jsx)("input",{type:"number",min:1,max:1e4,value:v,onChange:e=>j(Number(e.target.value)),className:"input input-bordered w-full max-w-xs"}),(0,t.jsx)("label",{className:"text-sm",children:"Max parameter combinations (iterations)"}),(0,t.jsx)("input",{type:"number",min:1,max:500,value:w,onChange:e=>k(Number(e.target.value)),className:"input input-bordered w-full max-w-xs"}),(0,t.jsx)("label",{className:"text-sm",children:"playExtraTendency values (comma separated)"}),(0,t.jsx)("input",{type:"text",value:E.join(","),onChange:e=>I(e.target.value.split(",").map(Number).filter(e=>!isNaN(e))),className:"input input-bordered w-full max-w-xs"}),(0,t.jsx)("label",{className:"text-sm",children:"maxAllowedJump values (comma separated)"}),(0,t.jsx)("input",{type:"text",value:L.join(","),onChange:e=>_(e.target.value.split(",").map(Number).filter(e=>!isNaN(e))),className:"input input-bordered w-full max-w-xs"}),(0,t.jsx)("label",{className:"text-sm",children:"pileHealthCaution values (comma separated)"}),(0,t.jsx)("input",{type:"text",value:R.join(","),onChange:e=>q(e.target.value.split(",").map(Number).filter(e=>!isNaN(e))),className:"input input-bordered w-full max-w-xs"}),(0,t.jsx)("label",{className:"text-sm",children:"bookingFrequency values (comma separated)"}),(0,t.jsx)("input",{type:"text",value:T.join(","),onChange:e=>G(e.target.value.split(",").map(Number).filter(e=>!isNaN(e))),className:"input input-bordered w-full max-w-xs"})]})]}),(0,t.jsxs)("button",{type:"submit",className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:P,children:[(0,t.jsx)(o,{className:"w-5 h-5"})," ",P?"Running...":"Run Simulation"]})]}),C&&(0,t.jsx)("div",{className:"mt-8",children:"single"===C.mode?(0,t.jsxs)("div",{className:"bg-gray-100 rounded-lg p-4 max-h-96 overflow-y-auto",children:[(0,t.jsx)("h2",{className:"font-bold mb-2",children:"Game Log"}),(0,t.jsx)("pre",{className:"text-xs whitespace-pre-wrap",children:C.log.join("\n")})]}):"multi"===C.mode?(0,t.jsxs)("div",{className:"bg-gray-100 rounded-lg p-4",children:[(0,t.jsx)("h2",{className:"font-bold mb-2",children:"Simulation Results"}),(0,t.jsxs)("div",{className:"flex flex-col gap-1 text-sm",children:[(0,t.jsxs)("span",{children:["Games played: ",C.numGames]}),(0,t.jsxs)("span",{children:["Players: ",C.numPlayers]}),(0,t.jsxs)("span",{children:["Win rate: ",(100*C.winRate).toFixed(2),"%"]}),(0,t.jsxs)("span",{children:["Average cards left: ",C.avgCardsLeft]}),(0,t.jsxs)("span",{children:["Booking frequency: ",0===M?"Never":1===M?"10-jump only":"10-jump or \xb11"]})]})]}):(0,t.jsxs)("div",{className:"bg-gray-100 rounded-lg p-4",children:[(0,t.jsx)("h2",{className:"font-bold mb-2",children:"Parameter Search Results"}),(0,t.jsx)("div",{className:"max-h-64 overflow-y-auto mb-2",children:(0,t.jsxs)("table",{className:"table-auto w-full text-xs",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"playExtraTendency"}),(0,t.jsx)("th",{children:"maxAllowedJump"}),(0,t.jsx)("th",{children:"pileHealthCaution"}),(0,t.jsx)("th",{children:"bookingFrequency"}),(0,t.jsx)("th",{children:"Win Rate"}),(0,t.jsx)("th",{children:"Avg Cards Left"})]})}),(0,t.jsx)("tbody",{children:C.results.slice(0,20).map((e,a)=>(0,t.jsxs)("tr",{className:0===a?"font-bold bg-blue-50":"",children:[(0,t.jsx)("td",{children:e.playExtraTendency}),(0,t.jsx)("td",{children:e.maxAllowedJump}),(0,t.jsx)("td",{children:e.pileHealthCaution}),(0,t.jsx)("td",{children:e.bookingFrequency}),(0,t.jsxs)("td",{children:[(100*e.winRate).toFixed(2),"%"]}),(0,t.jsx)("td",{children:e.avgCardsLeft})]},a))})]})}),(0,t.jsxs)("div",{className:"bg-gray-200 rounded p-2 max-h-32 overflow-y-auto text-xs",children:[(0,t.jsx)("div",{children:"Progress log:"}),(0,t.jsx)("pre",{children:J.join("\n")})]})]})})]})})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=134)}),_N_E=e.O()}]);